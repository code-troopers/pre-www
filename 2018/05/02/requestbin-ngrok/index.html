
<!doctype html>
<html class="no-js" lang="fr-fr" itemscope itemtype="http://schema.org/Organization">
<head>
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NWLQD2');</script>
  
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code-Troopers</title>
  <meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width" />

  <meta property="og:title" content=" Code-Troopers" />
  <meta property="og:site_name" content="Code-Troopers" />
  <meta property="og:url" content="https://code-troopers.com/" />
  <meta property="og:image" content="https://code-troopers.com/images/banner/logo-banner.png"/>


  <meta property="og:type" content="website" />


  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@codetroopers" />
  <meta name="twitter:creator" content="@codetroopers" />
  <meta name="twitter:title" content="Code-Troopers" />
  <meta name="twitter:url" content="https://code-troopers.com/" />


  <meta name="twitter:description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure." />
  <meta name="twitter:image" content="https://code-troopers.com/images/banner/logo-banner.png"/>
  <meta name="description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure." />
  <meta property="og:description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure."/>


  <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="theme-color" content="#3BCCE5" />


  <link href="https://code-troopers.com/index.xml" rel="alternate" type="application/rss+xml" title="Code-Troopers" />
  <link rel="canonical" href="https://code-troopers.com/" />
  <link rel="shortcut icon" href="../../../../favicon.ico?v=2" type="image/x-icon">
  <link rel="icon" href="../../../../favicon.ico?v=2" type="image/x-icon">
  <meta itemprop="name" content="Code-Troopers"/><link rel="stylesheet" href="../../../../styles.2481.css" /><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
  <script>
      window.addEventListener("load", function(){
          window.cookieconsent.initialise({
              "palette": {
                  "popup": {
                      "background": "#000"
                  },
                  "button": {
                      "background": "transparent",
                      "text": "#3BCCE5",
                      "border": "#3BCCE5"
                  }
              },
              "content": {
                  "message": "En poursuivant la navigation, vous acceptez l'utilisation de cookies.",
                  "dismiss": "J'ai compris",
                  "link": "En savoir plus"
              }
          })});
  </script>
</head>

<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NWLQD2"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<header>
    <nav>
        <a href="../../../../" class="brand"><img src="../../../../img/Code-Troopers.png" alt="Code-Troopers"></a>
        
            
            <a href="../../../../#skills" class=" "><span>Compétences</span></a>
            
        
            
            <a href="../../../../#portfolio" class=" "><span>Réalisations</span></a>
            
        
            
            <a href="../../../../#casting" class=" "><span>Casting</span></a>
            
        
            
            <a href="../../../../#contact" class=" "><span>Contact</span></a>
            
        
            
            <a href="../../../../blog" class=" active  blog"><span>Blog</span></a>
            
        
            
        
    </nav>
</header>
<section id="blog">
    <div class="wrapper">
        <h1>
            Blog
        </h1>
    </div>

    <section id="article">
        <div class="wrapper">
            <article>
                
                <img src="../../../../images/banner/requestbin-ngrok-banner.png">
                
                
                
                <div class="wrapper-content">
                    <h2>Tester ses webhooks avec RequestBin et ngrok</h2>
                    
                    
                    <ul class="tags">
                        
                        <li><a href="../../../../tags/requestbin/">RequestBin</a></li>
                        
                        <li><a href="../../../../tags/ngrok/">ngrok</a></li>
                        
                        <li><a href="../../../../tags/webhook-tester/">Webhook Tester</a></li>
                        
                    </ul>
                    
                    <div class="content">
                        <div class="paragraph">
<p><strong><a href="https://github.com/Runscope/requestbin" target="_blank" rel="noopener">RequestBin</a></strong> est un service qui permet de tester très facilement des webhooks que l&#8217;on souhaite brancher à une API, ou bien encore de tester son client HTTP en inspectant les requêtes qui sont émises.
Ce service était auparavant acccessible en ligne, mais victime de son succès, il a ensuite été retiré. Cependant leurs créateurs ont mis à disposition de la communauté les sources afin de permettre à n&#8217;importe qui d&#8217;heberger sa propre instance de <strong>RequestBin</strong>.</p>
</div>
<div class="paragraph">
<p>Nous allons donc voir avec quelle simplicité il est possible de tester rapidement ce service en local sur sa machine, et comment il va nous aider par exemple à faire de l&#8217;intégration de webhooks externes. Afin de faire cela en un minimum de configuration nous allons également utiliser <strong><a href="https://ngrok.com/" target="_blank" rel="noopener">ngrok</a></strong>, un second outil très pratique qui permet d&#8217;exposer sur une url publique un service tournant sur sa machine en local.</p>
</div>
<div class="sect1">
<h2 id="_requestbin"><strong>RequestBin</strong></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_déploiement">Déploiement</h3>
<div class="paragraph">
<p><em>Prérequis</em> : disposer de docker et de docker-compose sur la machine qui va heberger le service.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Récupérer les sources de <strong><a href="https://github.com/Runscope/requestbin" target="_blank" rel="noopener">RequestBin</a></strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git clone git://github.com/Runscope/requestbin.git</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Construction du service</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd requestbin
$ sudo docker-compose build</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Démarrage du service</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo docker-compose up -d</pre>
</div>
</div>
<div class="paragraph">
<p>C&#8217;est tout, le service est alors disponible sur le port 8000.</p>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/homepage.png" data-lightbox="0" title="Page d&#8217;accueil">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/homepage_min.png" alt="Page d&#8217;accueil"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p>Il est à noter que le projet est également préconfiguré pour deployer rapidement le service sur Heroku, seul l&#8217;addon <code>heroku-redis</code> est nécessaire : se référer à la documentation pour davantages d&#8217;informations à ce sujet.</p>
</div>
</div>
<div class="sect2">
<h3 id="_visualisation_de_requêtes_http">Visualisation de requêtes HTTP</h3>
<div class="paragraph">
<p>Une fois le service démarré, il est alors possible de commencer à débugger nos requêtes HTTP en quelques secondes.</p>
</div>
<div class="paragraph">
<p>Pour cela il suffit de cliquer sur <code>Create a RequestBin</code>. Un <em>Bin</em> va alors être généré et permettra donc d&#8217;écouter toutes les requêtes entrantes. Il s&#8217;agit ni plus ni moins d&#8217;un endpoint dynamique qui va accepter toutes les requêtes HTTP entrantes.</p>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/first_bin.png" data-lightbox="0" title="Exemple de Bin">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/first_bin_min.png" alt="Exemple de Bin"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p>Ensuite, comme l&#8217;indique le <em>Bin</em> on va pouvoir commencer à jouer avec en branchant nos webhooks ou clients à tester sur cette url, dans notre exemple il s&#8217;agit de <code><a href="http://localhost:8000/1hc5lg41" class="bare">http://localhost:8000/1hc5lg41</a></code>.
Voyons le résultat d&#8217;une requête POST d&#8217;un objet JSON quelconque :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell"><span></span>$ curl -H <span class="tok-s2">&quot;Content-Type: application/json&quot;</span> -d <span class="tok-s1">&#39;{&quot;username&quot;:&quot;GillesDor&quot;,&quot;password&quot;:&quot;v0dk@0r@nge&quot;}&#39;</span> http://localhost:8000/1hc5lg41</code></pre>
</div>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/result.png" data-lightbox="0" title="Visualisation d&#8217;une requête">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/result_min.png" alt="Visualisation d&#8217;une requête"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p>Après avoir rafraîchi la page, il est alors très simple de visualiser le résultat reçu par notre <em>Bin</em> : headers, body, paramètres, &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>Il devient alors très facile d&#8217;analyser les requêtes entrantes d&#8217;un webhook que l&#8217;on souhaite brancher à notre API avant d&#8217;implémenter son intégration à proprement parler. À l&#8217;inverse cela peut permettre également de voir les données qui vont être reçues par une API que l&#8217;on souhaite attaquer avec son propre client HTTP.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_redirection_de_requêtes_sur_son_environnement_avec_ngrok">Redirection de requêtes sur son environnement avec ngrok</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Afin d&#8217;aller plus loin dans la démarche, il peut être parfois nécessaire de configurer un webhook externe sur une url publique pour que ce dernier puisse nous envoyer ses requêtes.</p>
</div>
<div class="paragraph">
<p>Imaginons que l&#8217;on veuille d&#8217;abord tester les résultats envoyés par ce webhook en utilisant <strong>RequestBin</strong>. On a alors probablement lancé le service en local sur sa propre machine, qui elle même se trouve (au minimum) derrière un routeur que l&#8217;on a pas la possibilité (ou l&#8217;envie) de configurer pour effectuer la redirection de ports adequat pour atteindre notre machine.</p>
</div>
<div class="paragraph">
<p>Nous allons pouvoir nous abstraire de tout cela grâce à <strong><a href="https://ngrok.com/" target="_blank" rel="noopener">ngrok</a></strong>. Il s&#8217;agit d&#8217;un petit outil qui permet d&#8217;exposer des services locaux sur des urls publiques (en HTTP ou HTTPS), sans avoir à faire de quelconque configuration de notre équipement réseau.</p>
</div>
<div class="sect2">
<h3 id="_installation">Installation</h3>
<div class="paragraph">
<p>Il s&#8217;agit d&#8217;un simple <a href="https://ngrok.com/download" target="_blank" rel="noopener">binaire à télécharger</a>. Il est aussi possible de se créer un compte si l&#8217;on souhaite administrer plus finement les tunnels que l&#8217;on veut créer mais cette étape reste facultative pour le simple usage que nous souhaitons en faire.</p>
</div>
</div>
<div class="sect2">
<h3 id="_création_de_tunnel">Création de tunnel</h3>
<div class="paragraph">
<p>Une fois <strong>ngrok</strong> installé il est ensuite possible de monter une url publique vers notre serveur local en une seule commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell"><span></span>$ ngrok http <span class="tok-m">8000</span> -host-header<span class="tok-o">=</span><span class="tok-s2">&quot;localhost:8000&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/ngrok.png" data-lightbox="0" title="ngrok">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/ngrok_min.png" alt="ngrok"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p>Ici nous venons donc d&#8217;exposer notre serveur accessible sur le port 8000 de notre machine sur une url publique fournie par <strong>ngrok</strong>.
Ce dernier nous indique alors une url dynamique publique à utiliser, dans notre exemple il s&#8217;agit donc de <code><a href="https://4c4cdfa3.ngrok.io" class="bare">https://4c4cdfa3.ngrok.io</a></code> (ou en HTTP).</p>
</div>
<div class="paragraph">
<p>À partir de là nous avons bien accès à notre <strong>RequestBin</strong> local sur une url publique.</p>
</div>
</div>
<div class="sect2">
<h3 id="_branchement_du_webhook">Branchement du webhook</h3>
<div class="paragraph">
<p>Toute la mécanique est alors en place pour paramétrer correctement notre webhook public pour lui permettre de logger ses requêtes dans notre <strong>RequestBin</strong> local.
En effet il suffit de lui fournir comme url : <code><a href="https://4c4cdfa3.ngrok.io/1hc5lg41" class="bare">https://4c4cdfa3.ngrok.io/1hc5lg41</a></code>.</p>
</div>
<div class="paragraph">
<p>Afin de vérifier cela, un simple appel curl nous permettra de valider notre installation :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell"><span></span>$ curl -H <span class="tok-s2">&quot;Content-Type: application/json&quot;</span> -d <span class="tok-s1">&#39;{&quot;username&quot;:&quot;PierreBillon&quot;,&quot;password&quot;:&quot;la_bamba_triste&quot;}&#39;</span> https://4c4cdfa3.ngrok.io/1hc5lg41</code></pre>
</div>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/result_final.png" data-lightbox="0" title="Résultat final">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/result_final_min.png" alt="Résultat final"/>
</a>
</div>
<br/></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nous avons donc réussi à mettre en place un moyen de visualiser les requêtes HTTP entrantes d&#8217;un webhook public grâce à <strong>RequestBin</strong> et <strong>ngrok</strong>, et à moindre coût.</p>
</div>
<div class="paragraph">
<p>Dans la vraie vie cela permettra donc de visualiser les données reçues lorsque l&#8217;on veut intégrer les webhooks d&#8217;un quelconque service, avant ou pendant l&#8217;implémentation à proprement parler, pour avoir un contrôle sur les données qui vont transiter.</p>
</div>
<div class="paragraph">
<p>Effectivement, selon les services à intégrer la documentation des webhooks est généralement suffisante pour appréhender ces problématiques mais cela peut parfois être intéressant de manipuler directement les requêtes pour anticiper certains cas ou incompréhensions de la documentation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bonus">Bonus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nous avons vu une technique basée sur <strong>RequestBin</strong> pour logguer des requetes HTTP entrantes, moyennant quelques commandes à effectuer sur son poste. Il existe en fait d&#8217;autres services en ligne pour effectuer cela&#8230;&#8203;
On pourra citer notamment <strong><a href="https://webhook.site" target="_blank" rel="noopener">Webhook Tester</a></strong> qui est une solution clef en main pour tester des webhooks, comme son nom l&#8217;indique, et qui gère pour nous la mise à disposition d&#8217;une url publique.</p>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-05-02_requestbin-ngrok/webhook_tester.png" data-lightbox="0" title="Webhook Tester">
        <img class="medium" src="../../../../images/posts/2018-05-02_requestbin-ngrok/webhook_tester_min.png" alt="Webhook Tester"/>
</a>
</div>
<br/></p>
</div>
</div>
</div>

                    </div>
                    <div class="content-footer">
                        
                        <ul class="tags float">
                            
                            <li><a href="../../../../tags/requestbin/">RequestBin</a></li>
                            
                            <li><a href="../../../../tags/ngrok/">ngrok</a></li>
                            
                            <li><a href="../../../../tags/webhook-tester/">Webhook Tester</a></li>
                            
                        </ul>
                        
                        <section id="author">
                            <div class="date">Rédigé par <span class="author-name">Joris</span></div>
                        </section>
                    </div>
                    <div class="share">
                        <span>Partager</span>
                        <ul class="socials">
                            <li>
                                <a target="_blank" title="Facebook"
                                   href="https://www.facebook.com/sharer.php?u=http://code-troopers.com%2f2018%2f05%2f02%2frequestbin-ngrok%2f&t=Tester%20ses%20webhooks%20avec%20RequestBin%20et%20ngrok"
                                   class="facebook-button" rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;">
                                    <i class="fa fa-facebook"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Twitter"
                                   href="https://twitter.com/share?url=http://code-troopers.com%2f2018%2f05%2f02%2frequestbin-ngrok%2f&text=Tester%20ses%20webhooks%20avec%20RequestBin%20et%20ngrok&via=codetroopers"
                                   rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;">
                                    <i class="fa fa-twitter"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Google +"
                                   href="https://plus.google.com/share?url=http://code-troopers.com%2f2018%2f05%2f02%2frequestbin-ngrok%2f&hl=fr"
                                   class="google-button" rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;">
                                    <i class="fa fa-google-plus"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div style="clear:both"></div>


                    <div class="back">
                        <div class="pagination">
                            
                            <a href="../../../../2018/06/11/mame/" class="previous-page">
                                <div class="arrow"><div class="arrow_box_left arrow_box">
</div></div>
                                Article précédent
                            </a>
                            
                            
                            <a href="../../../../2018/04/27/android-demo-mode/" class="next-page">
                                Article suivant
                                <div class="arrow"><div class="arrow_box_right arrow_box">
</div></div>
                            </a>
                            
                        </div>
                    </div>

                    <section id="menu">
                        <ul>
                            
                        </ul>
                    </section>

                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                         
                        var disqus_shortname = 'codetroopers' 
                        var disqus_url = window.location.href
                        if (window.location.protocol != 'http:') {
                            disqus_url = 'http:' + window.location.href.substring(window.location.protocol.length)
                        }

                         
                        (function () {
                            var dsq = document.createElement('script')
                            dsq.type = 'text/javascript'
                            dsq.async = true
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq)
                        })()
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
                        powered by Disqus.</a></noscript>
                    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span
                            class="logo-disqus">Disqus</span></a>
                </div>
            </article>
        </div>
    </section>
</section>

<section id="contact">
    <h1>Contact</h1>


    <div>
        <div><iframe class="lozad"
                    width="100%"
                    height="100%"
                    frameborder="0" style="border:0"
                    data-src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDmneK7ppr9MWdY2ynnTXsnhEloW2r7GzQ&q=Code-Troopers,+37000+Tours+France&zoom=15">
            </iframe></div>
        <div>
            <h2>Code-Troopers</h2>
            <p>
                <strong>MAME</strong><br>
                Cité de la création et du numérique<br>
                49 boulevard Preuilly<br>
                37000 Tours - Fr
            </p>
            <p>
                <a href="mailto:contact@code-troopers.com">contact@code-troopers.com</a>
            </p>
            <p>
                <a class="button" href="tel:+33782287216">07 82 28 72 16</a>
            </p>
        </div>
    </div>

    <h1>Suivez nos actualités</h1>

    <ul class="flex">
        <li>
            <a href="https://facebook.com/codetroopers37">
                <i class="fa fa-facebook fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://twitter.com/codetroopers">
                <i class="fa fa-twitter fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://plus.google.com/+Code-troopers">
                <i class="fa fa-google-plus fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://github.com/code-troopers">
                <i class="fa fa-github fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="../../../../index.xml">
                <i class="fa fa-rss fa-3x fa-fw"></i>
            </a>
        </li>
    </ul>
</section>

<footer>
    <div class="wrapper">
        <a href="#top" class="scroll-to-top">
            <img class="arrow" src="../../../../img/arrow.png" alt="arrow">
        </a>
        <img src="../../../../img/footer_logo.png" alt="logo">
        <div>
            <span>©2014 — 2018 Code-Troopers | <a href="../../../../legals.html">Mentions légales</a></span>
            <span>Design : <a href="https://www.descheval.com/">descheval.com</a> | Développement : Code-Troopers</span>
        </div>
    </div>
</footer>
<script type="application/javascript" src="../../../../main.a8165d.js"></script>

<script type="application/javascript" src="../../../../blog.6bad53.js"></script>

</body>
</html>

